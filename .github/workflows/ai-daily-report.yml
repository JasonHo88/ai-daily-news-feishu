name: AIèµ„è®¯æ—¥æŠ¥è‡ªåŠ¨æ”¶é›†

# è§¦å‘æ–¹å¼ï¼š
# 1. å®šæ—¶è§¦å‘ï¼šæ¯å¤©UTC 0ç‚¹ï¼ˆåŒ—äº¬æ—¶é—´8ç‚¹ï¼‰
# 2. æ‰‹åŠ¨è§¦å‘ï¼šç‚¹å‡»æŒ‰é’®å³å¯è¿è¡Œ
on:
  schedule:
    # æ¯å¤©UTC 0ç‚¹æ‰§è¡Œï¼ˆåŒ—äº¬æ—¶é—´8:00ï¼‰
    - cron: '0 0 * * *'
  workflow_dispatch:
    inputs:
      debug:
        description: 'è°ƒè¯•æ¨¡å¼'
        required: false
        default: 'false'

# æƒé™è®¾ç½®
permissions:
  contents: read

# ä»»åŠ¡å®šä¹‰
jobs:
  collect-and-push:
    runs-on: ubuntu-latest
    timeout-minutes: 30
    
    steps:
      # 1. æ£€å‡ºä»£ç 
      - name: Checkout code
        uses: actions/checkout@v4
        
      # 2. è®¾ç½®Pythonç¯å¢ƒ
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'
          cache: 'pip'
          
      # 3. å®‰è£…ä¾èµ–
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install requests python-dotenv
          
      # 4. æ‰§è¡ŒAIèµ„è®¯æ”¶é›†å’Œæ¨é€ï¼ˆä¸€ä½“åŒ–è„šæœ¬ï¼‰
      - name: Collect AI News and Push to Feishu
        env:
          FEISHU_WEBHOOK_URL: ${{ secrets.FEISHU_WEBHOOK_URL }}
        run: |
          echo "========================================"
          echo "ğŸ¤– AIèµ„è®¯è‡ªåŠ¨æ”¶é›†ä»»åŠ¡"
          echo "æ—¶é—´: $(date)"
          echo "========================================"
          
          # ç›´æ¥è¿è¡Œä¸»è„šæœ¬
          python collect_ai_news.py
          
          # è®°å½•æ‰§è¡Œç»“æœ
          if [ $? -eq 0 ]; then
            echo ""
            echo "========================================"
            echo "âœ… ä»»åŠ¡å®Œæˆï¼"
            echo "========================================"
          else
            echo ""
            echo "========================================"
            echo "âŒ ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼ˆéƒ¨åˆ†æ­¥éª¤å¯èƒ½å¤±è´¥ï¼‰"
            echo "========================================"
          fi
